> rest-express@1.0.0 dev
> NODE_ENV=development tsx server/index.ts

âœ… Sentry error tracking initialized
âœ… Mixpanel analytics initialized
âœ“ Common agricultural ingredients initialized
Development mode: returning admin user info: {
  id: '44886248',
  email: 'tim@avallen.solutions',
  firstName: 'Tim',
  lastName: 'Admin',
  profileImageUrl: '',
  role: 'admin'
Development mode: returning admin user info: {
  id: '44886248',
  email: 'tim@avallen.solutions',
  firstName: 'Tim',
  lastName: 'Admin',
  profileImageUrl: '',
  role: 'admin'
}
Development mode: returning admin user info: {
  id: '44886248',
  email: 'tim@avallen.solutions',
  firstName: 'Tim',
  lastName: 'Admin',
  profileImageUrl: '',
  role: 'admin'
}
isAuthenticated middleware check for: /api/company/footprint {
  isAuthenticated: true,
  hasUser: true,
  hasExpiresAt: true,
  userObject: [ 'claims', 'expires_at', 'access_token', 'refresh_token' ]
}
Development mode: Creating mock user for testing
isAuthenticated middleware check for: /api/company/footprint/scope3/automated {
  isAuthenticated: true,
  hasUser: true,
  hasExpiresAt: true,
  userObject: [ 'claims', 'expires_at', 'access_token', 'refresh_token' ]
}
Development mode: Creating mock user for testing
isAuthenticated middleware check for: /api/dashboard/metrics {
  isAuthenticated: true,
  hasUser: true,
  hasExpiresAt: true,
  userObject: [ 'claims', 'expires_at', 'access_token', 'refresh_token' ]
}
Development mode: Creating mock user for testing
isAuthenticated middleware check for: /api/suggestions/next-steps {
  isAuthenticated: true,
  hasUser: true,
  hasExpiresAt: true,
  userObject: [ 'claims', 'expires_at', 'access_token', 'refresh_token' ]
}
Development mode: Creating mock user for testing
Using admin company with products: Demo Company ID: 1
Using admin company with products: Demo Company ID: 1
Using admin company with products: Demo Company ID: 1
Using admin company with products: Demo Company ID: 1
Water footprint calculation failed for Molasses, cane: TypeError: OpenLCAService.calculateWaterFootprint is not a function
    at <anonymous> (/home/runner/workspace/server/routes.ts:3777:60)
    at Array.map (<anonymous>)
    at <anonymous> (/home/runner/workspace/server/routes.ts:3763:58)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
ğŸ’§ Fallback water for Molasses, cane: 15L
ğŸ—‘ï¸ Waste footprint for Rum Blanc: 0.211 kg
Products fetched: 1 for company 1
ğŸ” Getting suggestions for company 1
ğŸ¢ Using company ID 1 for automated calculations
ğŸ” Calculating purchased goods for company 1
ğŸ“¦ Found 1 products for emissions calculation
ğŸ§® Processing product: Rum Blanc (ID: 12)
ğŸ§® Calculating OpenLCA-based emissions for Rum Blanc
ğŸ“‹ Found 1 ingredients
ğŸ” Calculating purchased goods for company 1
isAuthenticated middleware check for: /api/dashboard/kpis {
  isAuthenticated: true,
  hasUser: true,
  hasExpiresAt: true,
  userObject: [ 'claims', 'expires_at', 'access_token', 'refresh_token' ]
}
Development mode: Creating mock user for testing
ğŸ“¦ Found 1 products for emissions calculation
ğŸ§® Processing product: Rum Blanc (ID: 12)
ğŸ§® Calculating OpenLCA-based emissions for Rum Blanc
ğŸ“‹ Found 1 ingredients
Using admin company with products: Demo Company ID: 1
ğŸŒ± OpenLCA Molasses, cane: 1.5 kg = 1.335 kg CO2e
ğŸ¾ Glass bottle: 530.000g, 61.00% recycled = 0.258 kg CO2e
ğŸŒ± OpenLCA Molasses, cane: 1.5 kg = 1.335 kg CO2e
ğŸ¾ Glass bottle: 530.000g, 61.00% recycled = 0.258 kg CO2e
isAuthenticated middleware check for: /api/smart-goals {
  isAuthenticated: true,
  hasUser: true,
  hasExpiresAt: true,
  userObject: [ 'claims', 'expires_at', 'access_token', 'refresh_token' ]
}
Development mode: Creating mock user for testing
ğŸ’¾ Stored carbon footprint for Rum Blanc: 1.593 kg CO2e
ğŸ“Š Rum Blanc per-unit emissions: 1.593 kg CO2e per unit
ğŸ­ Rum Blanc annual production: 300,000 units
ğŸŒ Rum Blanc total annual emissions: 477.9 tonnes CO2e
ğŸ“‹ Generated 1 suggestions: [ 'Enhance Your Sustainability Reporting' ]
ğŸ’¾ Stored carbon footprint for Rum Blanc: 1.593 kg CO2e
ğŸ“Š Rum Blanc per-unit emissions: 1.593 kg CO2e per unit
ğŸ­ Rum Blanc annual production: 300,000 units
ğŸŒ Rum Blanc total annual emissions: 477.9 tonnes CO2e
isAuthenticated middleware check for: /api/company/water-footprint {
  isAuthenticated: true,
  hasUser: true,
  hasExpiresAt: true,
  userObject: [ 'claims', 'expires_at', 'access_token', 'refresh_token' ]
}
Development mode: Creating mock user for testing
Using admin company with products: Demo Company ID: 1
ğŸ” Product Rum Blanc: wastePerUnit=0.21090000000000003kg, annual=300000, total waste=63270.00000000001kg
ğŸ—‘ï¸ Total calculated waste: 63270.00000000001kg (63.27000000000001 tonnes)
ğŸ“ˆ Production dashboard metrics (FootprintWizard method):
   CO2e: 505.10 tonnes (505104.8 kg)
   Water: 0 litres
   Waste: 63.3 tonnes
ğŸ” DEBUG: Production path executed!
Using admin company with products: Demo Company ID: 1
isAuthenticated middleware check for: /api/reports {
  isAuthenticated: true,
  hasUser: true,
  hasExpiresAt: true,
  userObject: [ 'claims', 'expires_at', 'access_token', 'refresh_token' ]
}
Development mode: Creating mock user for testing
Using admin company with products: Demo Company ID: 1
ğŸŒ± OpenLCA water footprint for Molasses, cane: 39L
ğŸŒ± OpenLCA carbon footprint for Molasses, cane: 1.335 kg CO2e
â™»ï¸  Calculated total company recycled waste: 96990.0 kg annually
ğŸ“Š Calculated total company waste: 63270.0 kg annually
Admin feedback endpoint called